(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/unitProjectList/index"],{3391:function(e,t,i){"use strict";var s=i("9203"),n=i.n(s);n.a},"43ee":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(){i.e("components/u-mouth-top/u-mouth-top").then(function(){return resolve(i("35bd"))}.bind(null,i)).catch(i.oe)},n=function(){Promise.all([i.e("common/vendor"),i.e("components/uni-popup/uni-popup")]).then(function(){return resolve(i("52dd"))}.bind(null,i)).catch(i.oe)},o={data:function(){return{data:{},selected:-1,sonSelected:-1,popupTextareaValueLength:0,popup3TextareaValueLength:0,popupTextareaValue:"",popup3TextareaValue:"",remarks:[],remarkSon:[],mouth:"",year:"",selectUnionid:"",selectSonUnionid:"",selectRemark:"",departmentId:"",popupTitle:"",selectProject:{},headSelectItem:{},headItems:[],headItemsBackup:[],currentheadItems:-1,headPersion:"",isShowHeadPersion:!1}},onLoad:function(e){this.data=this.subTitleString(JSON.parse(e.item)),this.departmentId=this.data.departmentId,this.$refs.uMouthTopRef.fromParentValue(e.mouth),this.mouth=e.mouth,this.year=e.year},onShow:function(){this.findTaskByConditions(),-1!=this.selected&&""!=this.selectUnionid&&this.clickProjectBut(this.selected,this.selectUnionid),-1!=this.sonSelected&&""!=this.selectSonUnionid&&this.clickSonProjectBut(this.sonSelected,this.selectSonUnionid)},components:{uMouthTop:s,uniPopup:n},computed:{token:function(){return this.$store.getters.getToken},remarksLength:function(){return 0==this.remarks.length},remarkSonLength:function(){return 0==this.remarkSon.length}},methods:{subTitleString:function(e){for(var t=0;t<e.taskList.length;t++){e.taskList[t].titles="";var i=e.taskList[t].title;i.length>8&&(e.taskList[t].titles=i,e.taskList[t].title=i.substring(0,7)+"...");for(var s=0;s<e.taskList[t].child.length;s++){e.taskList[t].child[s].titles="";var n=e.taskList[t].child[s].title;n.length>8&&(e.taskList[t].child[s].titles=n,e.taskList[t].child[s].title=n.substring(0,7)+"...")}}return e},fromUMouthTopValue:function(e){this.mouth=e.id,this.findTaskByConditions()},clickProjectBut:function(e,t){var i=this;this.selected==e?(this.selected=-1,this.selectUnionid=""):(this.selectUnionid=t,this.selected=e,this.commonApi.findRoutineTaskRemarks(this.token,t).then((function(e){i.remarks=e.data.data})))},clickSonProjectBut:function(e,t){var i=this;this.sonSelected==e?(this.sonSelected=-1,this.selectSonUnionid=""):(this.sonSelected=e,this.selectSonUnionid=t,this.commonApi.findRoutineTaskRemarks(this.token,t).then((function(e){i.remarkSon=e.data.data})))},clickSubtasks:function(t){var i=JSON.stringify(t);e.navigateTo({url:"../subtasks/index?project="+i})},popupInputChange:function(e){this.popupTextareaValue=e.detail.value,this.popupTextareaValueLength=e.detail.value.length},popup3InputChange:function(e){this.popup3TextareaValue=e.detail.value,this.popup3TextareaValueLength=e.detail.value.length},clickNoteBut:function(e){this.selectRemark=e.unionId,this.$refs.popup.open()},popupTextBut:function(){var t=this;""!=this.popupTextareaValue?this.commonApi.addRoutineTaskRemarks(this.token,this.selectRemark,this.popupTextareaValue).then((function(i){e.showToast({title:"添加成功",duration:2e3,success:function(){setTimeout((function(){t.$refs.popup.close()}),2e3),-1!=t.selected&&""!=t.selectUnionid&&t.clickProjectBut(t.selected,t.selectUnionid),-1!=t.sonSelected&&""!=t.selectSonUnionid&&t.clickSonProjectBut(t.sonSelected,t.selectSonUnionid)}})})):e.showToast({title:"留言内容不能为空!",duration:2e3})},clickCuibanBut:function(e){this.headItems=[],this.headSelectItem=e,null!=e.supervisionLeader&&void 0!=e.supervisionLeader&&""!=e.supervisionLeader&&this.headItems.push({level:1,adminName:e.supervisionLeader}),null!=e.responsibleLeader&&void 0!=e.responsibleLeader&&""!=e.responsibleLeader&&e.responsibleLeader!=e.supervisionLeader&&this.headItems.push({level:2,adminName:e.responsibleLeader}),null!=e.responsible&&void 0!=e.responsible&&""!=e.responsible&&e.responsible!=e.supervisionLeader&&e.responsible!=e.responsibleLeader&&this.headItems.push({level:3,adminName:e.responsible}),this.headPersion="",this.popup3TextareaValue="",this.isShowHeadPersion=!1,this.$refs.popup3.open()},clickSonCuibanBut:function(e,t){this.headItems=[],this.headSelectItem=e,null!=this.data.supervisionLeader&&void 0!=this.data.supervisionLeader&&""!=this.data.supervisionLeader&&this.headItems.push({level:1,adminName:this.data.supervisionLeader}),null!=this.data.responsibleLeader&&void 0!=this.data.responsibleLeader&&""!=this.data.responsibleLeader&&this.data.responsibleLeader!=this.data.supervisionLeader&&this.headItems.push({level:2,adminName:this.data.responsibleLeader}),null!=t&&void 0!=t&&""!=t&&this.data.responsibleLeader!=t&&this.data.supervisionLeader!=t&&this.headItems.push({level:3,adminName:t}),null!=e.responsible&&void 0!=e.responsible&&""!=e.responsible&&e.responsible!=this.data.supervisionLeader&&e.responsible!=this.data.responsibleLeader&&t!=e.responsible&&this.headItems.push({level:4,adminName:e.responsible}),this.headPersion="",this.popup3TextareaValue="",this.isShowHeadPersion=!1,this.$refs.popup3.open()},findTaskByConditions:function(){var e=this;this.commonApi.findTaskByConditions(this.token,this.year,this.mouth,this.departmentId).then((function(t){0==t.data.data.length?e.data={}:e.data=e.subTitleString(t.data.data[0])}))},clickSubmitBut:function(e){this.selectProject=e,this.popupTitle="是否提交审批?",1!=e.status&&2!=e.status||(this.popupTitle="是否审批通过?"),this.$refs.popup2.open()},clickPopup2Confit:function(){this.$refs.popup2.close();var e=1;this.approvalRoutineTask(this.selectProject,e)},clickPopup2Cacue:function(){if(this.$refs.popup2.close(),0!=this.selectProject.status){var e=0;this.approvalRoutineTask(this.selectProject,e)}},approvalRoutineTask:function(t,i){var s=this;this.commonApi.approvalRoutineTask(this.token,t.unionId,i).then((function(t){e.showToast({title:"操作成功",duration:2e3}),s.findTaskByConditions()}))},clickPopup2Close:function(){this.$refs.popup2.close()},radioChange:function(e){for(var t=0;t<this.headItems.length;t++)if(console.info("headPersion: "+e.target.value),console.info("headPersion: "+this.headItems[t].level),this.headItems[t].level==e.target.value){this.currentheadItems=t,this.headPersion=this.headItems[t].adminName;break}this.isShowHeadPersion=!1},clickHeadPersion:function(){this.isShowHeadPersion=!0},updateSelectPersion:function(){if(""!=this.headPersion)if(""!=this.popup3TextareaValue){var t=this;this.commonApi.addUrgingRemarks(this.token,this.headSelectItem.unionId,this.headItems[this.currentheadItems].level,this.popup3TextareaValue).then((function(i){e.showToast({title:"发送成功",duration:2e3,success:function(){t.updateSelectPersionClose()}})}))}else e.showToast({title:"请输入发送内容",duration:2e3});else e.showToast({title:"请选择接收人",duration:2e3})},updateSelectPersionClose:function(){this.headPersion="",this.popup3TextareaValue="",this.isShowHeadPersion=!1,this.$refs.popup3.close()}}};t.default=o}).call(this,i("543d")["default"])},9203:function(e,t,i){},b314:function(e,t,i){"use strict";i.r(t);var s=i("43ee"),n=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,(function(){return s[e]}))}(o);t["default"]=n.a},e353:function(e,t,i){"use strict";(function(e){i("32ab");s(i("66fd"));var t=s(i("fb0e"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},eeac:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return s}));var s={uniPopup:function(){return Promise.all([i.e("common/vendor"),i.e("components/uni-popup/uni-popup")]).then(i.bind(null,"52dd"))}},n=function(){var e=this,t=e.$createElement,i=(e._self._c,JSON.stringify(e.data));e.$mp.data=Object.assign({},{$root:{g0:i}})},o=[]},fb0e:function(e,t,i){"use strict";i.r(t);var s=i("eeac"),n=i("b314");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("3391");var a,r=i("f0c5"),u=Object(r["a"])(n["default"],s["b"],s["c"],!1,null,"1c7a60ec",null,!1,s["a"],a);t["default"]=u.exports}},[["e353","common/runtime","common/vendor"]]]);